---
title: Opik
description: Monitor, debug, and optimize your AI SDK applications with Opik observability
---

# Opik Observability

[Opik](https://www.comet.com/opik/) is Comet's observability, evaluation, and optimization platform for LLM and agent workloads. The AI SDK emits OpenTelemetry spans that Opik turns into rich traces with token usage, latency, and cost breakdowns. You can replay conversations, inspect tool calls, and share traces with your team to accelerate debugging and experimentation.

## Setup

Telemetry in the AI SDK is currently experimental ([docs](/docs/ai-sdk-core/telemetry#enabling-telemetry)). Enable it on every request you want to trace by setting `experimental_telemetry.isEnabled`:

```ts highlight="4"
const result = await generateText({
  model: openai('gpt-4o'),
  prompt: 'Tell a joke about distributed tracing.',
  experimental_telemetry: { isEnabled: true },
});
```

To forward spans to Opik, install the exporter and set up your credentials.

```bash
npm install opik @vercel/otel @opentelemetry/api-logs @opentelemetry/instrumentation @opentelemetry/sdk-logs
```

Set your Opik environment variables (or pass them directly to the exporter constructor):

```bash filename=".env" wordWrap
OPIK_API_KEY="<opik-api-key>"
OPIK_URL_OVERRIDE="https://www.comet.com/opik/api" # omit for self-hosted deployments
OPIK_PROJECT_NAME="<project-name>"
OPIK_WORKSPACE="<workspace>"
OPIK_LOG_LEVEL="INFO" # optional
```

Register the exporter with OpenTelemetry.

<Tabs items={["Next.js", "Node.js"]}>
<Tab>

Next.js supports OpenTelemetry instrumentation at the framework level. Learn more in the [Next.js OpenTelemetry guide](https://nextjs.org/docs/app/building-your-application/optimizing/open-telemetry).

```ts filename="instrumentation.ts" highlight="6"
import { registerOTel } from '@vercel/otel';
import { OpikExporter } from 'opik/vercel';

export function register() {
  registerOTel({
    serviceName: 'opik-vercel-ai-nextjs-example',
    traceExporter: new OpikExporter(),
  });
}
```

</Tab>
<Tab>

```ts highlight="6, 9, 28"
import { openai } from '@ai-sdk/openai';
import { generateText } from 'ai';
import { NodeSDK } from '@opentelemetry/sdk-node';
import { getNodeAutoInstrumentations } from '@opentelemetry/auto-instrumentations-node';
import { OpikExporter } from 'opik/vercel';

const sdk = new NodeSDK({
  traceExporter: new OpikExporter(),
  instrumentations: [getNodeAutoInstrumentations()],
});

sdk.start();

async function main() {
  const result = await generateText({
    model: openai('gpt-4o'),
    maxOutputTokens: 64,
    prompt: 'Draft a short release note for telemetry support.',
    experimental_telemetry: OpikExporter.getSettings({
      name: 'opik-node-example',
      metadata: {
        customerId: 'abc-123',
      },
      tags: ['release-candidate'],
    }),
  });

  console.log(result.text);

  await sdk.shutdown(); // Flush traces to Opik
}

main().catch(console.error);
```

</Tab>
</Tabs>

Once the exporter is registered, every traced request appears in Opik with model inputs/outputs, token counts, latency metrics, and custom metadata.

## Configuration

### Custom tags and metadata

Add tags or metadata to all traces generated by the exporter:

```ts
const exporter = new OpikExporter({
  tags: ['production', 'checkout'],
  metadata: {
    environment: 'production',
    version: '1.2.0',
    owner: 'growth-team',
  },
});
```

Tags make it easy to filter and compare traces, while metadata surfaces structured context in the Opik UI.

### Custom trace names

Provide a custom trace name for each request:

```ts
await generateText({
  model: openai('gpt-4o'),
  prompt: 'Summarize the latest telemetry improvements.',
  experimental_telemetry: OpikExporter.getSettings({
    name: 'custom-trace-name',
  }),
});
```

### Debugging

Set the log level to `DEBUG` to print exporter diagnostics while developing:

```bash filename=".env"
OPIK_LOG_LEVEL=DEBUG
```

## Example application

Explore the [Opik + AI SDK example](https://github.com/comet-ml/opik/tree/main/examples/vercel-ai-sdk) to see a complete integration, including custom metadata and multi-step workflows.
