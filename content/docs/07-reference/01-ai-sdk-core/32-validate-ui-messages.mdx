---
title: validateUIMessages
description: API Reference for validateUIMessages
---

# `validateUIMessages`

`validateUIMessages` is an async function that validates UI messages against schemas for metadata, data parts, and tools. It ensures type safety and data integrity for your message arrays before processing or rendering.

## Basic Usage

Simple validation without custom schemas:

```typescript
import { validateUIMessages } from 'ai';

const messages = [
  {
    id: '1',
    role: 'user',
    parts: [{ type: 'text', text: 'Hello!' }],
  },
];

const validatedMessages = await validateUIMessages({
  messages,
});
```

## Advanced Usage

Comprehensive validation with custom metadata, data parts, and tools:

```typescript
import { validateUIMessages, tool } from 'ai';
import { z } from 'zod';

// Define schemas
const metadataSchema = z.object({
  timestamp: z.string().datetime(),
  userId: z.string(),
});

const dataSchemas = {
  chart: z.object({
    data: z.array(z.number()),
    labels: z.array(z.string()),
  }),
  image: z.object({
    url: z.string().url(),
    caption: z.string(),
  }),
};

const tools = {
  weather: tool({
    description: 'Get weather info',
    parameters: z.object({
      location: z.string(),
    }),
    execute: async ({ location }) => `Weather in ${location}: sunny`,
  }),
};

// Messages with custom parts
const messages = [
  {
    id: '1',
    role: 'user',
    metadata: { timestamp: '2024-01-01T00:00:00Z', userId: 'user123' },
    parts: [
      { type: 'text', text: 'Show me a chart' },
      {
        type: 'data-chart',
        data: { data: [1, 2, 3], labels: ['A', 'B', 'C'] },
      },
    ],
  },
  {
    id: '2',
    role: 'assistant',
    parts: [
      {
        type: 'tool-weather',
        toolCallId: 'call_123',
        state: 'output-available',
        input: { location: 'San Francisco' },
        output: 'Weather in San Francisco: sunny',
      },
    ],
  },
];

// Validate with all schemas
const validatedMessages = await validateUIMessages({
  messages,
  metadataSchema,
  dataSchemas,
  tools,
});
```

## Validation Behavior

### Tool Part Lifecycle States

`validateUIMessages` validates tool parts across all seven lifecycle states:

| State | Description | Key Fields |
| -------------------- | ----------------------------------------- | --------------------------------------------------- |
| `input-streaming` | Tool input is being streamed | `input` (optional) |
| `input-available` | Tool input is fully available | `input` (required) |
| `approval-requested` | Waiting for user approval | `input`, `approval.id` |
| `approval-responded` | User has approved or denied | `input`, `approval.id`, `approval.approved` |
| `output-available` | Tool execution completed successfully | `input`, `output` |
| `output-error` | Tool execution failed | `input`, `errorText` |
| `output-denied` | User denied tool execution | `input`, `approval.id`, `approval.approved` (false) |

All tool part types (`tool-*` and `dynamic-tool`) support an optional `title` field for human-readable display names.

### Tool Input Schema Validation

When the `tools` parameter is provided, tool input is validated against the tool's `inputSchema` only for these states:

- `input-available`
- `output-available`
- `output-error` (when `input` is present)

Input is **not** validated for `input-streaming`, `approval-requested`, `approval-responded`, or `output-denied` states.

### Dynamic Tool Handling

Dynamic tool parts (with `type: 'dynamic-tool'`) are structurally validated â€” their shape, required fields, and lifecycle state are all checked. However, when the `tools` parameter is provided, dynamic tool input and output are **not** schema-validated against tool definitions. Only static tool parts (with `type: 'tool-*'`) have their input and output validated against the matching tool schema.

Additionally, `dynamic-tool` parts in the `output-available` state are validated to ensure the `output` field is present.
