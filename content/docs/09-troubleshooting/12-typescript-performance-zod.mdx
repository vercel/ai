---
title: TypeScript performance issues with Zod and AI SDK 5
description: Troubleshooting TypeScript server crashes and slow performance when using Zod with AI SDK 5
---

# TypeScript performance issues with Zod and AI SDK 5

## Issue

When using the AI SDK 5 with Zod, you may experience:

- TypeScript server crashes or hangs
- Extremely slow type checking in files that import AI SDK functions
- Error messages like "Type instantiation is excessively deep and possibly infinite"
- IDE becoming unresponsive when working with AI SDK code

## Background

The AI SDK 5 has specific compatibility requirements with Zod versions. When importing Zod using the standard import path (`import { z } from 'zod'`), TypeScript's type inference can become excessively complex, leading to performance degradation or crashes.

## Solution

### Update TypeScript Configuration

The recommended solution is to update your `tsconfig.json` to use `moduleResolution: "nodenext"`:

```json
{
  "compilerOptions": {
    "moduleResolution": "nodenext"
    // ... other options
  }
}
```

This resolves the TypeScript performance issues while allowing you to continue using the standard Zod import:

```typescript
import { z } from 'zod'; // Works correctly with nodenext module resolution
```

After making this change, restart your TypeScript server (in VS Code: `Cmd/Ctrl + Shift + P` → "TypeScript: Restart TS Server").

### Alternative: Use the Zod Version-Specific Import Path

If the above solution doesn't resolve the issue, you can try importing Zod using a version-specific import path:

```typescript
// ❌ Potentially problematic: Standard import may cause TypeScript issues
import { z } from 'zod';

// ✅ Alternative: version-specific import that may help with compatibility
import { z } from 'zod/v4';
```
